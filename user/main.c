/*********************************OWL-IOT32*********************************                                      
 
	                         \\\|///
                       \\  - -  //
                        (  @ @  )
+---------------------oOOo-(_)-oOOo-------------------------+
|                                                           |
|                             Oooo                          |
+-----------------------oooO--(   )-------------------------+
                       (   )   ) /
                        \ (   (_/
                         \_)           
***************************************************************************/
#include "stm32f10x.h"
#include "board_config.h"
#include "sys_rcc.h"
#include "SysTick.h"
#include "Led_driver.h"
#include "beep_driver.h"
#include "TIM_driver.h"
#include "usart_driver.h"
#include "spi_driver.h"
#include "i2c_driver.h"
#include "adc_driver.h"
#include "OLED_Device.h"
#include "dht11_driver.h"
#include "key_driver.h"
#include "rc522_driver.h"
#include "bma250e_driver.h"
#include "RTL8710_driver.h"
#include "tlsr8266_ble_driver.h"
#include "Bluetooth.h"
#include "eeprom.h"

#include "Run_task.h"

uint8_t OWL_128X64[] = {
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,
0x80,0x80,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xE0,0xE0,0xE0,
0xE0,0xE0,0xE0,0xE0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0x80,0x80,
0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0xF8,0xFC,
0xFC,0xFC,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0x9F,0x1F,
0x3F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x3F,
0x3F,0x1F,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFC,0xFC,
0xFC,0xF8,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xF8,0xFE,0xFF,0xFF,0xFF,0xFF,
0xFF,0x3F,0xFF,0xFF,0xBC,0x0C,0x0C,0x05,0xF7,0xFB,0xFB,0xFF,0xFF,0xFF,0xFF,0xFE,
0xFE,0xFC,0x18,0x19,0xB9,0xF3,0xF3,0xE3,0x47,0xCF,0x8F,0x9F,0x9F,0x9F,0xCF,0xCF,
0xEF,0xCF,0xCF,0x9F,0x9F,0x9F,0x8F,0xCF,0xC7,0xE3,0xF3,0xF1,0x39,0x18,0x7C,0xFC,
0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFB,0xF7,0x67,0x05,0x0C,0x1C,0xFF,0xFF,0x7F,0x7F,
0xFF,0xFF,0xFF,0xFF,0xFE,0xFC,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x1F,0x3F,0x7F,0xFF,0x3F,
0x3F,0x3E,0x3D,0x3B,0xB3,0xB6,0xF4,0xEC,0xEC,0xE9,0xE9,0xE9,0xEB,0xEB,0xE9,0x69,
0x3D,0x04,0x0C,0x0E,0x27,0x33,0x31,0x32,0x31,0x71,0xB1,0x81,0xC1,0xE1,0xF9,0xF9,
0xF9,0xF9,0xF1,0xC1,0x81,0xB1,0x71,0x31,0x33,0x32,0x33,0x27,0x07,0x0E,0x04,0x1C,
0x29,0x69,0xE9,0xEB,0xE9,0xE9,0xE9,0xE8,0xEC,0xF4,0xB6,0xB7,0x3B,0x39,0x3C,0x3F,
0x1F,0xFF,0xFF,0x3F,0x1F,0x0F,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x1B,
0x39,0x39,0x3D,0x3D,0x3D,0x3D,0x34,0x3C,0x34,0x38,0x28,0x39,0x39,0x79,0x70,0x70,
0x60,0xE0,0xC1,0xC1,0xC1,0xC3,0xC3,0xC3,0x83,0x87,0x87,0x8F,0x8F,0x0F,0x1F,0x3F,
0x3F,0x3F,0x0F,0x8F,0x8F,0x87,0x87,0x83,0x83,0xC3,0xC3,0xC1,0xC1,0xC1,0xE0,0x60,
0x70,0x70,0x71,0x79,0x39,0x28,0x28,0x3C,0x34,0x34,0x3C,0x3D,0x3D,0x3D,0x39,0x39,
0x19,0x1B,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x3F,0xFF,0xFF,0xFE,0xC0,0xF0,0xF0,0xF0,0xF0,0xC0,0xF0,
0xFF,0xFF,0x7F,0x00,0x00,0x00,0x00,0x80,0xE0,0xF0,0xFC,0xFE,0xFF,0xCF,0xCF,0xFF,
0xFE,0xF8,0xF0,0xC0,0x80,0x00,0x00,0x06,0x07,0x07,0x07,0x07,0xFF,0xFF,0xFF,0xFF,
0x07,0x07,0x07,0x07,0x07,0x02,0x00,0x00,0x00,0xFC,0xFE,0xFE,0xFF,0x8F,0x07,0x07,
0x07,0x07,0x8F,0x8E,0x8E,0x8E,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0x70,
0x70,0x70,0x70,0x70,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x02,0xFF,0xFF,
0xFF,0xFF,0x77,0x77,0x77,0x77,0x77,0x67,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,
0xFF,0xFF,0xFF,0xE7,0x67,0xE7,0xE7,0xF7,0xFF,0xFE,0xBE,0x1C,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x07,0x07,0x07,0x07,0x01,0x01,0x07,0x07,0x07,
0x07,0x03,0x00,0x00,0x00,0x00,0x00,0x07,0x07,0x07,0x07,0x01,0x00,0x00,0x00,0x00,
0x01,0x07,0x07,0x07,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x07,0x07,0x07,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x07,0x07,0x07,0x07,0x07,
0x07,0x07,0x07,0x07,0x03,0x03,0x00,0x00,0x00,0x00,0x00,0x07,0x07,0x07,0x07,0x00,
0x00,0x00,0x00,0x00,0x07,0x07,0x07,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x07,
0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x07,
0x07,0x07,0x07,0x00,0x00,0x00,0x00,0x01,0x07,0x07,0x07,0x07,0x00,0x00,0x00,0x00,
/*"F:\‰∏âÂçéÊô∫ËÅîÁßëÊäÄÊúâÈôêÂÖ¨Âè∏logo\OWL-128X64.bmp",0*/
};

const u8 nonside[] =
{
	0x00,0x00,0x80,0xC0,0xE0,0xF0,0xF8,0xFC,0xF8,0xF0,0xE0,0xC0,0x80,0x00,0x00,0x00,
	0x00,0x00,0x00,0x01,0x03,0x07,0x0F,0x1F,0x0F,0x07,0x03,0x01,0x00,0x00,0x00,0x00,//°Ù0,
};


void RFID_Test(void)
{
	unsigned char g_ucTempbuf[20];
	while(1)
	{
//		//—≠ª∑…®√ËIC…‰∆µø®
		if(Card_handle(g_ucTempbuf,NULL) == 5)//…®√ËµΩIC…‰∆µø®
		{
			uint8_t i = 0;
			//∂¡»°”√ªß–≈œ¢±‡∫≈
			Card_Look_User(g_ucTempbuf);
			printf("CARD ID:");
			for(i = 0;i < 20;i++)
				printf("%d ",g_ucTempbuf[i]);
			printf("\r\n");
		}
		
		delay_ms(1000);
		delay_ms(1000);
	}
}

void Board_Init(void)
{
	RCC_Configuration();
	SysTick_init(72);
	
//	WIFI_RTL8710_Startup();
	
	LED_GPIO_InitConfig();
	Beep_InitConfig();
	TIM_InitConfig();
	USART_InitConfig();
	Sof_I2C_Init();
	SPI_InitConfig();
	ADC1_Init();

	DHT11_GPIO_Config();
	Key_GPIOConfig();

//	LCD_Init();
//	LCD_P8x16Str(20,3,"OWL-IOT32 V2");
//	LCD_P6x8Str(20,5,"OWL-IOT32 V2");
//	delay_ms(1000);
//	delay_ms(1000);
//	delay_ms(1000);
//	LCD_CLS();
//	delay_ms(1000);
//	delay_ms(1000);
	
//	Draw_BMP(0,0,nonside);
//	Draw_BMP(5,5,OWL_128X64);
//	Draw_BMP(0,0,128,7,OWL_128X64);

//	RC522_Init();
	
//	RFID_Test();
//	
//	BMA250E_Init();

	printf("Hello\r\n");
	
//	WIFI_RTL8710_Init();
	TLSR8266_Init();

//	Bluetooth_Init();
	while(1);
}

int main(void)
{
	Board_Init();
	Run_Start();
}


